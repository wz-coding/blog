---
date: 2024-01-08
category: 
   - Vue
   - Vue3
tag: ref 相关

---

# ref 相关
`ref` 函数是 Vue3 中用于创建响应式数据的方法之一，也是 Vue3 响应式系统的核心功能之一，下面我们将探究 `ref` 函数的用法及实现原理。

## 使用方法
### ref
`ref` 函数在 Vue3 中的作用是将原始值转化为响应式数据，它的用法非常简单，只需要传入一个原始值作为参数即可。
```js
const count = ref(0)
console.log(count.value) // 0

count.value++
console.log(count.value) // 1
```
### shallowRef
`shallowRef` 函数的作用与 `ref` 函数类似，但是它只对传入的值进行浅层响应式处理，而不会对嵌套的属性进行响应式处理。
```js
const state = shallowRef({
  count: 0
});

state.value.count++;
console.log(state.value.count); // 1
```
### triggerRef
`triggerRef` 函数的作用是手动触发 `ref` 对象的响应式更新。
### isRef
`isRef` 函数接收一个参数并返回一个布尔值，用于判断该参数是否为 `ref` 转化的对象。
```js
const count = ref(0);
console.log(isRef(count)); // true
console.log(isRef(123)); // false
```

### unref
`unref` 函数接收一个参数并返回该参数的值，如果参数为 `ref` 对象，则返回该对象的值，否则返回该参数本身。
```js
const count = ref(0);
const countValue = unref(count);
console.log(countValue); // 0

const countValue = unref(123);
console.log(countValue); // 123
```

### toRef
`toRef` 函数接收两个参数，第一个参数为对象，第二个参数为属性名，返回一个 `ref` 对象，该对象的值与传入的对象的属性值相同。
```js
const state = reactive({
  count: 0
});

const countRef = toRef(state, 'count');
console.log(countRef.value); // 0

countRef.value++;
console.log(state.count); // 1
```

### toRefs
`toRefs` 函数接收一个对象作为参数，返回一个对象，该对象的每个属性都是 `ref` 对象，其值与传入对象的属性值相同。
```js
const state = reactive({
  count: 0,
  name: 'Vue3'
});

const stateRefs = toRefs(state);
console.log(stateRefs.count.value); // 0
console.log(stateRefs.name.value); // 'Vue3'

stateRefs.count.value++;
console.log(state.count); // 1
```

## 实现原理
`ref` 函数的实现原理非常简单，它接收一个原始值作为参数，并返回一个 `ref` 对象，该对象的 `value` 属性保存了原始值的引用。当访问 `ref` 对象的 `value` 属性时，会自动解包，返回原始值。当修改 `ref` 对象的 `value` 属性时，会触发响应式更新。
```js
function ref(value) {
  return {
    value,
    get value() {
      return value;
    },
    set value(newValue) {
      value = newValue;
    }
  };
}
```
        
## 参考资料
- [Vue3 官方文档](https://v3.cn.vuejs.org/guide/reactivity-fundamentals.html)
- [Vue3 源码解析](https://github.com/answershuto/learnVue)
- [Vue3 源码分析之 ref](https://juejin.cn/post/68449039816927851534)
- [Vue3 源码分析之 reactive](https://juejin.cn/post/68449039816927851534)

